var RadGrid=function(a){"object"!==typeof a&&(a={});void 0!==a.canvas&&"CANVAS"==a.canvas.nodeName?this.canvas=a.canvas:null!==document.getElementById(a.canvas)?this.canvas=document.getElementById(a.canvas):(this.canvas=document.createElement("canvas"),document.body.appendChild(this.canvas));"BODY"==this.canvas.parentNode.nodeName?(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,document.body.style.margin="0"):(this.canvas.width=window.getComputedStyle(this.canvas.parentNode).getPropertyValue("width").replace("px",
""),this.canvas.height=window.getComputedStyle(this.canvas.parentNode).getPropertyValue("height").replace("px",""),this.canvas.parentNode.style.padding="0",this.canvas.parentNode.style.margin="0");this.canvas.style.width="100%";this.canvas.style.height="100%";this.canvas.style.position="absolute";this.canvas.style.top=0;this.canvas.style.left=0;this.canvas.style.zIndex=1;this.canvas.style.cursor="move";this.cursorStateAsClass=!0;this.canvas.className="grab";this.draw=this.canvas.getContext("2d");
this.animateLoopBound=this.animateLoop.bind(this);this.resizeCanvasBound=this.resizeCanvas.bind(this);window.addEventListener("resize",this.resizeCanvasBound);this.interactionCaptureBound=this.interactionCapture.bind(this);this.canvas.addEventListener("mousedown",this.interactionCaptureBound);this.canvas.addEventListener("touchstart",this.interactionCaptureBound);this.interactionChangeBound=this.interactionChange.bind(this);this.canvas.addEventListener("mousemove",this.interactionChangeBound);this.canvas.addEventListener("touchmove",
this.interactionChangeBound);this.interactionReleaseBound=this.interactionRelease.bind(this);this.canvas.addEventListener("mouseup",this.interactionReleaseBound);this.canvas.addEventListener("touchend",this.interactionReleaseBound);for(var b=[["gridSize",24],["radius",8],["numberOfPoints",24],["speed",64],["backgroundColor","#f68cff"],["noBackground",!1],["animateBackgroundHue",!1],["hueLowestValue",80],["hueHighestValue",208],["hueSpeed",2],["gridColor","#fff"],["gridThickness",1],["useCirclesInstead",
!1],["text","Cool."],["fontFamily","Arial"],["makeItalic",!0],["makeBold",!0],["textColor","#ffffff"],["shadowColor","#000000"],["fontSize",64],["lineHeight",2],["shadowOffset",2]],c=0;c<b.length;c++)void 0===a[b[c][0]]?this[b[c][0]]=b[c][1]:typeof a[b[c][0]]===typeof b[c][1]&&(this[b[c][0]]=a[b[c][0]]);this.hueRGB=[this.hueHighestValue,this.hueLowestValue,this.hueLowestValue];this.hueLastSettings=[this.hueLowestValue,this.hueHighestValue];this.resetGridStrength=1;this.pointsToBePulled=Array(this.numberOfPoints);
this.pause=this.initialized=!1;this.fillEdge=0;this.initialize();this.devMode=!1};
RadGrid.prototype.destroy=function(){this.playPause();window.removeEventListener("resize",this.resizeCanvasBound);this.canvas.removeEventListener("mousedown",this.interactionCaptureBound);this.canvas.removeEventListener("touchstart",this.interactionCaptureBound);this.interactionChangeBound=this.interactionChange.bind(this);this.canvas.removeEventListener("mousemove",this.interactionChangeBound);this.canvas.removeEventListener("touchmove",this.interactionChangeBound);this.canvas.removeEventListener("mouseup",
this.interactionReleaseBound);this.canvas.removeEventListener("touchend",this.interactionReleaseBound)};
RadGrid.prototype.initialize=function(){var a=Math.ceil(this.canvas.width/this.gridSize)+1,a=a+2*Math.round(this.radius/2),b=Math.ceil(this.canvas.height/this.gridSize)+1,b=b+2*Math.round(this.radius/2);this.verticies=Array(a);this.originalVerticies=Array(a);for(a=0;a<this.verticies.length;a++){this.verticies[a]=Array(b);this.originalVerticies[a]=Array(b);for(var c=0;c<this.verticies[a].length;c++)this.verticies[a][c]=[a*this.gridSize,c*this.gridSize],this.originalVerticies[a][c]=[a*this.gridSize,
c*this.gridSize]}!1===this.initialized&&(this.animation=window.requestAnimationFrame(this.animateLoopBound));this.initialized=!0};
RadGrid.prototype.drawGrid=function(){this.draw.strokeStyle=this.gridColor;this.draw.lineWidth=this.gridThickness;for(var a=0;a<this.verticies[0].length;a++){this.draw.moveTo(0,0);this.draw.beginPath();for(var b=0;b<this.verticies.length;b++)this.draw.lineTo(this.verticies[b][a][0],this.verticies[b][a][1]);this.draw.stroke();this.draw.closePath()}for(a=0;a<this.verticies.length;a++){this.draw.moveTo(0,0);this.draw.beginPath();for(b=0;b<this.verticies[0].length;b++)this.draw.lineTo(this.verticies[a][b][0],
this.verticies[a][b][1]);this.draw.stroke();this.draw.closePath()}};RadGrid.prototype.drawCircles=function(){this.draw.fillStyle=this.gridColor;for(var a=0;a<this.verticies[0].length;a++)for(var b=0;b<this.verticies.length;b++)this.draw.beginPath(),this.draw.arc(this.verticies[b][a][0],this.verticies[b][a][1],this.gridThickness,0,2*Math.PI),this.draw.fill(),this.draw.closePath()};
RadGrid.prototype.resizeCanvas=function(){"BODY"==this.canvas.parentNode.nodeName?(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight):(this.canvas.width=window.getComputedStyle(this.canvas.parentNode).getPropertyValue("width").replace("px",""),this.canvas.height=window.getComputedStyle(this.canvas.parentNode).getPropertyValue("height").replace("px",""));!0===this.pause?this.animateLoop():this.initialize()};
RadGrid.prototype.interactionPosition=function(a,b,c,e,d){this.currentCoordinates=[a-d.left,b-d.top];this.originalCoordinates=[this.currentCoordinates[0],this.currentCoordinates[1]];this.nearestPointOnGrid=[Math.round(this.currentCoordinates[0]/c)+Math.round(e/2),Math.round(this.currentCoordinates[1]/c)+Math.round(e/2)]};
RadGrid.prototype.interactionCapture=function(a){if(!1===this.pause)if("touchstart"===a.type){if("undefined"===typeof this.interactionArray){this.interactionArray=Array(a.targetTouches.length);for(var b=0;b<this.interactionArray.length;b++)this.interactionArray[b]={touchEnded:!0}}this.interactionArray.length<a.targetTouches.length&&this.interactionArray.push({touchEnded:!0});for(var c,b=0;b<this.interactionArray.length;b++)for(var e=0;e<a.targetTouches.length;e++){c="undefined"===typeof this.interactionArray[b].identity||
10<a.targetTouches[e].identifier;var d=a.targetTouches[e].identifier===this.interactionArray[b].identity;!0===c?!0===this.interactionArray[b].touchEnded&&(d=this.canvas.getBoundingClientRect(),this.interactionArray[b]=new this.interactionPosition(a.targetTouches[b].clientX,a.targetTouches[b].clientY,this.gridSize,this.radius,d),this.interactionArray[b].point=new this.PointToPull([this.verticies.length,this.verticies[0].length],this.gridSize,this.radius,this.speed,this.interactionArray[b].nearestPointOnGrid),
this.interactionArray[b].identity=a.targetTouches[b].identifier,this.interactionArray[b].touchEnded=!1):!0===d&&!0===this.interactionArray[b].touchEnded&&(d=this.canvas.getBoundingClientRect(),this.interactionArray[b]=new this.interactionPosition(a.targetTouches[e].clientX,a.targetTouches[e].clientY,this.gridSize,this.radius,d),this.interactionArray[b].point=new this.PointToPull([this.verticies.length,this.verticies[0].length],this.gridSize,this.radius,this.speed,this.interactionArray[b].nearestPointOnGrid),
this.interactionArray[b].identity=a.targetTouches[e].identifier,this.interactionArray[b].touchEnded=!1)}}else if("mousedown"===a.type){!0===this.cursorStateAsClass&&(this.canvas.className="grabbing");b=[a.clientX-this.canvas.getBoundingClientRect().left,a.clientY-this.canvas.getBoundingClientRect().top];e=!1;if("undefined"!==typeof this.interactionArray)for(d=0;d<this.interactionArray.length;d++)b[0]===this.interactionArray[d].currentCoordinates[0]&&b[1]===this.interactionArray[d].currentCoordinates[1]&&
(e=!0);!1===e&&(d=this.canvas.getBoundingClientRect(),this.mouse=new this.interactionPosition(a.clientX,a.clientY,this.gridSize,this.radius,d),this.mouse.point=new this.PointToPull([this.verticies.length,this.verticies[0].length],this.gridSize,this.radius,this.speed,this.mouse.nearestPointOnGrid),this.mouse.lifted=!1)}};
RadGrid.prototype.incrementInput=function(a,b,c,e){var d=[0,0];!0===c?!1===this.interactionArray[e].touchEnded&&(d[0]=(a-this.interactionArray[e].originalCoordinates[0])/this.gridSize,d[0]=0>d[0]?-1*d[0]:d[0],d[1]=(b-this.interactionArray[e].originalCoordinates[1])/this.gridSize,d[1]=0>d[1]?-1*d[1]:d[1],this.interactionArray[e].point.increment[0]=d[0]>this.radius?0:a-this.interactionArray[e].currentCoordinates[0],this.interactionArray[e].point.increment[1]=d[1]>this.radius?0:b-this.interactionArray[e].currentCoordinates[1],
this.pullPoint(this.interactionArray[e].point),this.interactionArray[e].currentCoordinates[0]=d[0]<this.radius?a:this.interactionArray[e].currentCoordinates[0],this.interactionArray[e].currentCoordinates[1]=d[1]<this.radius?b:this.interactionArray[e].currentCoordinates[1]):!1===this.mouse.lifted&&(d[0]=(a-this.mouse.originalCoordinates[0])/this.gridSize,d[0]=0>d[0]?-1*d[0]:d[0],d[1]=(b-this.mouse.originalCoordinates[1])/this.gridSize,d[1]=0>d[1]?-1*d[1]:d[1],this.mouse.point.increment[0]=d[0]>this.radius?
0:a-this.mouse.currentCoordinates[0],this.mouse.point.increment[1]=d[1]>this.radius?0:b-this.mouse.currentCoordinates[1],this.pullPoint(this.mouse.point),this.mouse.currentCoordinates[0]=d[0]<this.radius?a:this.mouse.currentCoordinates[0],this.mouse.currentCoordinates[1]=d[1]<this.radius?b:this.mouse.currentCoordinates[1])};
RadGrid.prototype.interactionChange=function(a){if(!1===this.pause)if(a.preventDefault(),"touchmove"===a.type)for(var b=0;b<a.targetTouches.length;b++)for(var c=0;c<this.interactionArray.length;c++){var e=a.targetTouches[b].clientX-this.canvas.getBoundingClientRect().left;var d=a.targetTouches[b].clientY-this.canvas.getBoundingClientRect().top;a.targetTouches[b].identifier===this.interactionArray[c].identity&&this.incrementInput(e,d,!0,c)}else"mousemove"===a.type&&"undefined"!==typeof this.mouse&&
!1===this.mouse.lifted&&(e=a.clientX-this.canvas.getBoundingClientRect().left,d=a.clientY-this.canvas.getBoundingClientRect().top,this.incrementInput(e,d,!1))};
RadGrid.prototype.interactionRelease=function(a){if(!1===this.pause)if("touchend"===a.type)for(var b=0;b<a.changedTouches.length;b++)for(var c=0;c<this.interactionArray.length;c++)a.changedTouches[b].identifier===this.interactionArray[c].identity&&(this.interactionArray[c].touchEnded=!0,this.interactionArray[c].point.pullStrength=[-1*(this.interactionArray[c].currentCoordinates[0]-this.interactionArray[c].originalCoordinates[0]),-1*(this.interactionArray[c].currentCoordinates[1]-this.interactionArray[c].originalCoordinates[1])],
this.interactionArray[c].point.increment=[this.interactionArray[c].point.pullStrength[0]/this.speed,this.interactionArray[c].point.pullStrength[1]/this.speed]);else"mouseup"===a.type&&(!0===this.cursorStateAsClass&&(this.canvas.className="grab"),"undefined"!==typeof this.mouse&&(this.mouse.lifted=!0,this.mouse.point.pullStrength=[-1*(this.mouse.currentCoordinates[0]-this.mouse.originalCoordinates[0]),-1*(this.mouse.currentCoordinates[1]-this.mouse.originalCoordinates[1])],this.mouse.point.increment=
[this.mouse.point.pullStrength[0]/this.speed,this.mouse.point.pullStrength[1]/this.speed]))};
RadGrid.prototype.pullInputPointsBack=function(){if("undefined"!==typeof this.interactionArray)for(var a=0;a<this.interactionArray.length;a++)!0===this.interactionArray[a].touchEnded&&!1===this.interactionArray[a].point.finished&&(0<this.interactionArray[a].point.pullStrength[0]?this.interactionArray[a].point.progress>=this.interactionArray[a].point.pullStrength[0]?this.interactionArray[a].point.finished=!0:this.interactionArray[a].point.progress=this.pullPoint(this.interactionArray[a].point):0>this.interactionArray[a].point.pullStrength[0]&&
(this.interactionArray[a].point.progress<=this.interactionArray[a].point.pullStrength[0]?this.interactionArray[a].point.finished=!0:this.interactionArray[a].point.progress=this.pullPoint(this.interactionArray[a].point)));"undefined"!==typeof this.mouse&&!0===this.mouse.lifted&&!1===this.mouse.point.finished&&(0<this.mouse.point.pullStrength[0]?this.mouse.point.progress>=this.mouse.point.pullStrength[0]?this.mouse.point.finished=!0:this.mouse.point.progress=this.pullPoint(this.mouse.point):0>this.mouse.point.pullStrength[0]&&
(this.mouse.point.progress<=this.mouse.point.pullStrength[0]?this.mouse.point.finished=!0:this.mouse.point.progress=this.pullPoint(this.mouse.point)))};
RadGrid.prototype.cycleThroughAllPointsToBePulled=function(){if(this.tempGridSize!==this.gridSize||this.tempRadius!==this.radius){this.initialize();for(var a=0;a<this.numberOfPoints;a++)this.pointsToBePulled[a]=this.createPullPoint()}else if(0!==this.numberOfPoints)for(a=0;a<this.numberOfPoints;a++)"undefined"!==typeof this.pointsToBePulled[a]?!1===this.pointsToBePulled[a].finished?0>this.pointsToBePulled[a].delay?(this.pointsToBePulled[a].progress=this.pullPoint(this.pointsToBePulled[a]),0<this.pointsToBePulled[a].pullStrength[0]?
(this.pointsToBePulled[a].progress>=this.pointsToBePulled[a].pullStrength[0]&&(this.pointsToBePulled[a].backToStart=!0,this.pointsToBePulled[a].increment[0]*=-1,this.pointsToBePulled[a].increment[1]*=-1),0>=this.pointsToBePulled[a].progress&&!0===this.pointsToBePulled[a].backToStart&&(this.pointsToBePulled[a].finished=!0)):(this.pointsToBePulled[a].progress<=this.pointsToBePulled[a].pullStrength[0]&&(this.pointsToBePulled[a].backToStart=!0,this.pointsToBePulled[a].increment[0]*=-1,this.pointsToBePulled[a].increment[1]*=
-1),0<=this.pointsToBePulled[a].progress&&!0===this.pointsToBePulled[a].backToStart&&(this.pointsToBePulled[a].finished=!0))):--this.pointsToBePulled[a].delay:this.pointsToBePulled[a]=this.createPullPoint():this.pointsToBePulled[a]=this.createPullPoint();this.tempGridSize=this.gridSize;this.tempRadius=this.radius};
RadGrid.prototype.animateHue=function(){if(this.hueLastSettings[0]!==this.hueLowestValue||this.hueLastSettings[1]!==this.hueHighestValue)this.hueRGB=[this.hueHighestValue,this.hueLowestValue,this.hueLowestValue];if(50>this.hueHighestValue-this.hueLowestValue||2<this.hueSpeed)this.hueSpeed=2;this.hueRGB[0]===this.hueHighestValue&&(this.hueRGB[1]===this.hueLowestValue&&(this.hueRGB[2]=this.hueRGB[2]-this.hueSpeed>this.hueLowestValue?this.hueRGB[2]-this.hueSpeed:this.hueLowestValue),this.hueRGB[2]===
this.hueLowestValue&&(this.hueRGB[1]=this.hueRGB[1]+this.hueSpeed<this.hueHighestValue?this.hueRGB[1]+this.hueSpeed:this.hueHighestValue));this.hueRGB[1]===this.hueHighestValue&&(this.hueRGB[0]=this.hueRGB[0]-this.hueSpeed>this.hueLowestValue?this.hueRGB[0]-this.hueSpeed:this.hueLowestValue,this.hueRGB[0]===this.hueLowestValue&&(this.hueRGB[2]=this.hueRGB[2]+this.hueSpeed<this.hueHighestValue?this.hueRGB[2]+this.hueSpeed:this.hueHighestValue));this.hueRGB[2]===this.hueHighestValue&&(this.hueRGB[0]===
this.hueLowestValue&&(this.hueRGB[1]=this.hueRGB[1]-this.hueSpeed>this.hueLowestValue?this.hueRGB[1]-this.hueSpeed:this.hueLowestValue),this.hueRGB[1]===this.hueLowestValue&&(this.hueRGB[0]=this.hueRGB[0]+this.hueSpeed<this.hueHighestValue?this.hueRGB[0]+this.hueSpeed:this.hueHighestValue));return"rgb("+Math.round(this.hueRGB[0])+","+Math.round(this.hueRGB[1])+","+Math.round(this.hueRGB[2])+")"};
RadGrid.prototype.animateLoop=function(){!0===this.devMode&&"undefined"!==typeof stats&&stats.begin();!1===this.noBackground?(!1===this.animateBackgroundHue?this.draw.fillStyle=this.backgroundColor:(this.backgroundColor=this.animateHue(),this.draw.fillStyle=this.backgroundColor,this.hueLastSettings=[this.hueLowestValue,this.hueHighestValue]),this.draw.fillRect(0,0,this.canvas.width,this.canvas.height)):this.draw.clearRect(0,0,this.canvas.width,this.canvas.height);0!==this.gridThickness&&(this.pullInputPointsBack(),
this.fillEdge=Math.round(this.radius/2)*this.gridSize,this.draw.translate(-1*this.fillEdge,-1*this.fillEdge),this.cycleThroughAllPointsToBePulled(),this.resetGrid(),!1===this.useCirclesInstead?this.drawGrid():this.drawCircles(),this.draw.translate(this.fillEdge,this.fillEdge));""!==this.text&&this.createText();!0===this.devMode&&"undefined"!==typeof stats&&stats.end();!1===this.pause&&window.requestAnimationFrame(this.animateLoopBound)};
RadGrid.prototype.createPullPoint=function(){return new this.PointToPull([this.verticies.length,this.verticies[0].length],this.gridSize,this.radius,this.speed)};RadGrid.prototype.playPause=function(){!0===this.pause?(window.requestAnimationFrame(this.animateLoopBound),this.pause=!1):this.pause=!0};RadGrid.prototype.saveImage=function(a){if(!0===a)window.open(this.canvas.toDataURL());else return this.canvas.toDataURL()};
RadGrid.prototype.PointToPull=function(a,b,c,e,d,f){this.centerPoint=[0,0];Array.isArray(d)?(this.calledByMouse=!0,this.centerPoint[0]=d[0],this.centerPoint[1]=d[1]):(this.calledByMouse=!1,this.centerPoint[0]=Math.round(Math.random()*a[0]),this.centerPoint[1]=Math.round(Math.random()*a[1]));!0===this.calledByMouse?this.pullStrength=[0,0]:(this.pullStrength=[0,0],a=Math.round(Math.random()*c/2)*b,d=Math.round(Math.random()*c/2)*b,this.pullStrength[0]=0===Math.round(Math.random())?a:-1*a,this.pullStrength[1]=
0===Math.round(Math.random())?d:-1*d);this.leftOfCenter=this.centerPoint[0]-c;this.rightOfCenter=this.centerPoint[0]+c;this.topOfCenter=this.centerPoint[1]-c;this.bottomOfCenter=this.centerPoint[1]+c;this.distanceCenterToEdge=c*b;this.increment=!0===this.calledByMouse?[0,0]:[this.pullStrength[0]/e,this.pullStrength[1]/e];this.delay=Math.floor(Math.random()*e);this.progress=0;this.finished=this.backToStart=!1};
RadGrid.prototype.pullPoint=function(a){for(var b=a.topOfCenter,c,e;b<=a.bottomOfCenter;){for(var d=a.leftOfCenter;d<=a.rightOfCenter;)"undefined"!==typeof this.verticies[d]&&"undefined"!==typeof this.verticies[d][b]&&(c=this.verticies[d][b][0]-a.centerPoint[0]*this.gridSize,e=this.verticies[d][b][1]-a.centerPoint[1]*this.gridSize,c=Math.sqrt(Math.pow(c,2)+Math.pow(e,2)),c<a.distanceCenterToEdge&&(c=1-Math.pow(c/a.distanceCenterToEdge,2),c=Math.pow(c,2.5),this.verticies[d][b][0]+=a.increment[0]*c,
this.verticies[d][b][1]+=a.increment[1]*c)),d++;b++}return a.progress+a.increment[0]};
RadGrid.prototype.resetGrid=function(){for(var a=0;a<this.verticies.length;a++)for(var b=0;b<this.verticies[a].length;b++)this.verticies[a][b][0]!==this.originalVerticies[a][b][0]&&0!==this.resetGridStrength&&(this.verticies[a][b][0]+=(this.originalVerticies[a][b][0]-this.verticies[a][b][0])/(this.speed*this.resetGridStrength)),this.verticies[a][b][1]!==this.originalVerticies[a][b][1]&&0!==this.resetGridStrength&&(this.verticies[a][b][1]+=(this.originalVerticies[a][b][1]-this.verticies[a][b][1])/
(this.speed*this.resetGridStrength))};
RadGrid.prototype.createText=function(){for(var a=[this.text],b,c=0;c<a.length;c++){for(b=!0;this.draw.measureText(a[c]).width>this.canvas.width&&!0===b;)-1<a[c].indexOf(" ")?("undefined"===typeof a[c+1]?a.push(a[c].substring(a[c].lastIndexOf(" "))):a[c+1]=a[c].substring(a[c].lastIndexOf(" "))+a[c+1],a[c]=a[c].substring(0,a[c].lastIndexOf(" "))):b=!1;"undefined"!==typeof a[c+1]&&(a[c+1]=a[c+1].substring(1))}b=this.fontSize*this.lineHeight;b=b*(a.length/2-1)+b/2;for(var e=!0===this.makeItalic?"italic ":
"",d=!0===this.makeBold?"bold ":"",f=0;f<a.length;f++)this.draw.font=e+d+this.fontSize+"pt "+this.fontFamily,this.draw.textAlign="center",this.draw.textBaseline="middle",this.draw.fillStyle=this.shadowColor,c=0<f?this.lineHeight*this.fontSize*f:0,0!==this.shadowOffset&&this.draw.fillText(a[f],this.canvas.width/2+this.shadowOffset,this.canvas.height/2+this.shadowOffset+c-b),this.draw.fillStyle=this.textColor,this.draw.fillText(a[f],this.canvas.width/2,this.canvas.height/2+c-b)};
